<div class="container">
  <div class="form-container">
    <div class="hike-card">
      <form [formGroup]="hikeForm" (ngSubmit)="false">
        <!-- Form fields -->
      <div class="form-field">
        <div class="form-title">
        <p translate="hike-creation.hikeName"></p>


        </div>
        <div class="form-field-bg">
          <mat-form-field appearance="outline">
            <input matInput type="text" formControlName="nomRandonnee">
            <mat-error *ngIf="nomRandonnee?.invalid && (nomRandonnee?.dirty || nomRandonnee?.touched)">
              <span *ngIf="nomRandonnee?.errors?.['required']">{{'hike-creation.nameRequired' | translate}}</span>
              <span *ngIf="nomRandonnee?.errors?.['minlength']">{{'hike-creation.name4car' | translate}}</span>
              <span *ngIf="nomRandonnee?.errors?.['maxlength']">{{'hike-creation.name70car' | translate}}</span>
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Image upload -->
      <div class="form-field">
        <div class="form-title">
          <p>{{'hike-creation.hikeImage' | translate}}</p>
        </div>
        <div class="dropzone">
          <h3>{{'hike-creation.dragDropFile' | translate}}</h3>
          <h3>{{'hike-creation.or' | translate}}</h3>
          <br>
          <label for="fileDropRef">{{'hike-creation.browseFile' | translate}}</label>
          <input type="file" accept="image/*" (change)="displayImage($event)">
          <img class="preview-image" *ngIf="imagePreview && !image?.invalid" [src]="imagePreview" alt="Selected Image" class="preview-image">
        </div>
        <mat-error *ngIf="imageSelected && image?.invalid">
          <span *ngIf="image?.errors?.['required']">{{'hike-creation.imageRequired' | translate}}</span>
          <span *ngIf="image?.errors?.['invalidFileType']">{{'hike-creation.wrongFormat' | translate}}</span>
          <span *ngIf="image?.errors?.['invalidFileContent']">{{'hike-creation.invalidFile' | translate}}</span>
        </mat-error>
      </div>

      <!-- Description -->
      <div class="form-field">
        <div class="form-title">
          <p>{{'hike-creation.description' | translate}}</p>
        </div>
        <mat-form-field appearance="outline">
          <textarea matInput formControlName="description"></textarea>
          <mat-hint>{{ description?.value?.length }}/255</mat-hint>
          <mat-error *ngIf="description?.invalid && (description?.dirty || description?.touched)">
            {{'hike-creation.description255car' | translate}}
          </mat-error>
        </mat-form-field>
      </div>


     <!-- Location -->
<div class="form-field">
  <div class="form-title">
    <p>{{'hike-creation.location' | translate}}</p>
  </div>
  <mat-form-field appearance="outline">
    <input matInput type="text" formControlName="location">
  </mat-form-field>
  <mat-error *ngIf="location?.invalid && (location?.dirty || location?.touched)">
    {{'hike-creation.locationRequired' | translate}}
  </mat-error>
</div>

      <!-- Type (Vélo ou pied) -->
      <div class="form-field">
        <div class="form-title">
          <p>{{'hike-creation.type' | translate}}</p>
        </div>
        
        <div class="button-group">
          <button [ngClass]="{'selected': hikeType === 'marche'}" (click)="setHikeType('marche')">
            <i class="fas fa-walking"></i>
          </button>
          <button [ngClass]="{'selected': hikeType === 'vélo'}" (click)="setHikeType('vélo')">
            <i class="fas fa-bicycle"></i>
          </button>
        </div>
      </div>



      </form>

      <!-- Toggle buttons for selecting points A and B -->
      

      <!-- Display latitude and longitude for selected points -->
      
    </div>
  </div>

  <!-- Map section -->
  <div class="map-container">
    <button class="btnSend" (click)="onSubmit()" [disabled]="!hikeForm.valid || !isFormValid() || !arePointsSelected() ">
      {{'hike-creation.createHike' | translate}}
    </button>
    <div class="button-container">
      <button (click)="choosePoint('A')" [class.selected]="selectedPoint === 'A'">
        <i class="fas fa-play"></i><br>
        {{'hike-creation.startPoint' | translate}}
      </button>
      <button (click)="choosePoint('B')" [class.selected]="selectedPoint === 'B'">
        <i class="fas fa-flag-checkered"></i><br>
        {{'hike-creation.endPoint' | translate}}
      </button>
    <!-- Display latitude and longitude for selected points -->
    <div class="point-info" *ngIf="selectedPoint === 'A' && pointALatitude !== null && pointALongitude !== null">
      <p>Point de départ Latitude: {{ pointALatitude }}</p>
      <p>Point de départ Longitude: {{ pointALongitude }}</p>
    </div>
    <div class="point-info" *ngIf="selectedPoint === 'B' && pointBLatitude !== null && pointBLongitude !== null">
      <p>Point d'arrivée Latitude: {{ pointBLatitude }}</p>
      <p>Point d'arrivée Longitude: {{ pointBLongitude }}</p>
    </div>
    <div *ngIf="selectedPoint !== 'A' && (pointALatitude === null || pointALongitude === null)">
      <p class="error-message">{{'hike-creation.startPointRequired' | translate}}</p>
    </div>
    <div *ngIf="selectedPoint !== 'B' && (pointBLatitude === null || pointBLongitude === null)">
      <p class="error-message">{{'hike-creation.endPointRequired' | translate}}</p>
    </div>

    </div>
    <div class="map-section">
      <google-map id="map" #mapAB [center]="center" [zoom]="zoom" (mapClick)="placeMarker($event)" [width]="'100%'" [height]="'100%'">
        <map-marker *ngFor="let marker of markers" [position]="marker.position" height="100%"></map-marker>
      </google-map>
    </div>
  </div>
</div>
